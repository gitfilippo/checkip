---
- name: Get IP addresses from Linux servers
  hosts: all
  gather_facts: true
  tasks:
    - name: Get IP addresses for all interfaces
      ansible.builtin.shell: ip addr show | grep "inet " | awk '{print $2}'
      register: ip_addresses
      changed_when: false

    - name: Display IP addresses
      ansible.builtin.debug:
        msg: "IP addresses on {{ inventory_hostname }}:\n{{ ip_addresses.stdout_lines | to_nice_yaml }}"

    - name: Get interface details
      ansible.builtin.shell: ip link show
      register: interfaces
      changed_when: false

    - name: Display interface details  
      ansible.builtin.debug:
        msg: "Network interfaces on {{ inventory_hostname }}:\n{{ interfaces.stdout_lines | to_nice_yaml }}"
